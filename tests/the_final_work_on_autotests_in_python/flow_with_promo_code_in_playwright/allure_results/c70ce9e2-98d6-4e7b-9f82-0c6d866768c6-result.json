{"name": "Проверка повторного использования купона", "status": "failed", "statusDetails": {"message": "AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 5000ms\n  -   - waiting for locator(\"//div[contains(text(), 'Регистрация завершена')]\")", "trace": "self = <test_flow_with_promo_code.TestFlowPromoCode object at 0x000001D1B342D880>\ngo_to_url = <function go_to_url.<locals>.callback at 0x000001D1B398F310>\npage = <Page url='https://pizzeria.skillbox.cc/register/'>\n\n    @allure.title('Проверка повторного использования купона')\n    def test_coupon_reuse_check(self, go_to_url, page: Page):\n        \"\"\"\n        Сценарий №4\n        1. зарегистрируйте одного пользователя;\n        2. сделайте любой заказ;\n        3. примените промокод GIVEMEHALYAVA;\n        4. оформите заказ;\n        5. попробуйте оформить второй заказ с этим же промокодом;\n        6. убедитесь, что второй раз промокод уже не срабатывает для пользователя.\n    \n        Шаги:\n            1. Перейти на страницу \"Мой аккаунт\"\n            2. Сделать клик по кнопке \"Зарегистрироваться\"\n            3. Заполнить обязательные поля валидными значениями\n            4. Нажать на кнопку \"Зарегистрироваться\"\n            5. Перейти на главную страницу\n            6. Навести курсор на любую пиццу в слайдере\n            7. Сделать клик по кнопке \"В корзину\"\n            8. Навести курсор на другую пиццу в слайдере\n            9. Сделать клик по кнопке \"В корзину\"\n            10. Проверить что нет активного купона, если есть удалить\n            11. Перейти на страницу \"Оформление заказа\"\n            12. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            13. Ввести в поле купон\n            14. Нажать на кнопку \"Применить купон\"\n            15. Заполнить все обязательные поля формы \"Детали заказа\"\n            16. Нажать на кнопку \"Оформить заказ\"\n            17. Перейти на главную страницу\n            18. Навести курсор на любую пиццу в слайдере\n            19. Сделать клик по кнопке \"В корзину\"\n            20. Навести курсор на другую пиццу в слайдере\n            21. Сделать клик по кнопке \"В корзину\"\n            22. Перейти на страницу \"Оформление заказа\"\n            23. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            24. Ввести в поле купон\n            25. Нажать на кнопку \"Применить купон\"\n            26. Заполнить все обязательные поля формы \"Детали заказа\"\n            27. Нажать на кнопку \"Оформить заказ\"\n            28. Проверить, что купон при втором заказе не применился\n    \n        Предусловие: пользователь не зарегистрирован и не авторизован на сайте https://pizzeria.skillbox.cc/\n    \n        Тестовые данные:\n             Username = zlo1\n             Password = qwe123!@#\n             Coupon = GIVEMEHALYAVA\n        \"\"\"\n        path_order_subtotal = \"//th[contains(text(), 'Subtotal')]/following-sibling::td/span\"\n        path_order_total = \"//th[contains(text(), 'Total')]/following-sibling::td/span\"\n        coupon = \"GIVEMEHALYAVA\"\n        username = \"po12\"\n        email = \"po12@mail.ru\"\n        password = \"qwe123!@#\"\n    \n        go_to_url(\"https://pizzeria.skillbox.cc/\")\n>       registration_user(page, username, email, password)\n\ntest_flow_with_promo_code.py:242: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npage = <Page url='https://pizzeria.skillbox.cc/register/'>, username = 'po12'\nemail = 'po12@mail.ru', password = 'qwe123!@#'\n\n    @allure.step('Регистрация нового пользователя')\n    def registration_user(page: Page, username, email, password):\n        path_page_my_account = \"(//a[contains(text(), 'Мой аккаунт')])[1]\"\n        path_button_registration = \"//button[contains(text(),'Зарегистрироваться')]\"\n        path_field_username = \"//input[@id='reg_username']\"\n        path_field_email = \"//input[@id='reg_email']\"\n        path_field_password = \"//input[@id='reg_password']\"\n        path_info_message = \"//div[contains(text(), 'Регистрация завершена')]\"\n        logging.info('Start mode registration user')\n        with step('Перейти на страницу \"Мой аккаунт\"'):\n            page.locator(path_page_my_account).click()\n        with step('Нажать на кнопку \"Зарегистрироваться\"'):\n            page.locator(path_button_registration).click()\n        with step('Ввести в поле \"Имя пользователя\" валидное значение'):\n            page.locator(path_field_username).type(username)\n        with step('Ввести в поле \"Адрес почты\" валидный email'):\n            page.locator(path_field_email).type(email)\n        with step('Ввести в поле \"Пароль\" валидный пароль'):\n            page.locator(path_field_password).type(password)\n        with step('Сделать клик по кнопке \"Зарегистрироваться\"'):\n            page.locator(path_button_registration).click()\n>           expect(page.locator(path_info_message)).to_be_visible(timeout=5000)\nE           AssertionError: Locator expected to be visible\nE           Actual value: <element(s) not found> \nE           Call log:\nE             - LocatorAssertions.to_be_visible with timeout 5000ms\nE             -   - waiting for locator(\"//div[contains(text(), 'Регистрация завершена')]\")\n\n..\\..\\..\\src\\actions\\helper\\registration_user.py:28: AssertionError"}, "description": "\n        Сценарий №4\n        1. зарегистрируйте одного пользователя;\n        2. сделайте любой заказ;\n        3. примените промокод GIVEMEHALYAVA;\n        4. оформите заказ;\n        5. попробуйте оформить второй заказ с этим же промокодом;\n        6. убедитесь, что второй раз промокод уже не срабатывает для пользователя.\n\n        Шаги:\n            1. Перейти на страницу \"Мой аккаунт\"\n            2. Сделать клик по кнопке \"Зарегистрироваться\"\n            3. Заполнить обязательные поля валидными значениями\n            4. Нажать на кнопку \"Зарегистрироваться\"\n            5. Перейти на главную страницу\n            6. Навести курсор на любую пиццу в слайдере\n            7. Сделать клик по кнопке \"В корзину\"\n            8. Навести курсор на другую пиццу в слайдере\n            9. Сделать клик по кнопке \"В корзину\"\n            10. Проверить что нет активного купона, если есть удалить\n            11. Перейти на страницу \"Оформление заказа\"\n            12. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            13. Ввести в поле купон\n            14. Нажать на кнопку \"Применить купон\"\n            15. Заполнить все обязательные поля формы \"Детали заказа\"\n            16. Нажать на кнопку \"Оформить заказ\"\n            17. Перейти на главную страницу\n            18. Навести курсор на любую пиццу в слайдере\n            19. Сделать клик по кнопке \"В корзину\"\n            20. Навести курсор на другую пиццу в слайдере\n            21. Сделать клик по кнопке \"В корзину\"\n            22. Перейти на страницу \"Оформление заказа\"\n            23. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            24. Ввести в поле купон\n            25. Нажать на кнопку \"Применить купон\"\n            26. Заполнить все обязательные поля формы \"Детали заказа\"\n            27. Нажать на кнопку \"Оформить заказ\"\n            28. Проверить, что купон при втором заказе не применился\n\n        Предусловие: пользователь не зарегистрирован и не авторизован на сайте https://pizzeria.skillbox.cc/\n\n        Тестовые данные:\n             Username = zlo1\n             Password = qwe123!@#\n             Coupon = GIVEMEHALYAVA\n        ", "steps": [{"name": "Открываем страницу 'https://pizzeria.skillbox.cc/'", "status": "passed", "parameters": [{"name": "url", "value": "'https://pizzeria.skillbox.cc/'"}], "start": 1749210464682, "stop": 1749210465922}, {"name": "Регистрация нового пользователя", "status": "failed", "statusDetails": {"message": "AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 5000ms\n  -   - waiting for locator(\"//div[contains(text(), 'Регистрация завершена')]\")\n\n", "trace": "  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\allure_commons\\_allure.py\", line 202, in impl\n    return func(*a, **kw)\n  File \"C:\\Users\\Lenovo\\OneDrive\\Рабочий стол\\Автотесты\\python-autotests-basic\\src\\actions\\helper\\registration_user.py\", line 28, in registration_user\n    expect(page.locator(path_info_message)).to_be_visible(timeout=5000)\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\sync_api\\_generated.py\", line 20256, in to_be_visible\n    self._sync(self._impl_obj.to_be_visible(visible=visible, timeout=timeout))\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_sync_base.py\", line 115, in _sync\n    return task.result()\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_assertions.py\", line 677, in to_be_visible\n    await self._expect_impl(\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_assertions.py\", line 74, in _expect_impl\n    raise AssertionError(\n"}, "steps": [{"name": "Перейти на страницу \"Мой аккаунт\"", "status": "passed", "start": 1749210465922, "stop": 1749210466127}, {"name": "Нажать на кнопку \"Зарегистрироваться\"", "status": "passed", "start": 1749210466127, "stop": 1749210466607}, {"name": "Ввести в поле \"Имя пользователя\" валидное значение", "status": "passed", "start": 1749210466608, "stop": 1749210466652}, {"name": "Ввести в поле \"Адрес почты\" валидный email", "status": "passed", "start": 1749210466652, "stop": 1749210466691}, {"name": "Ввести в поле \"Пароль\" валидный пароль", "status": "passed", "start": 1749210466691, "stop": 1749210466707}, {"name": "Сделать клик по кнопке \"Зарегистрироваться\"", "status": "failed", "statusDetails": {"message": "AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 5000ms\n  -   - waiting for locator(\"//div[contains(text(), 'Регистрация завершена')]\")\n\n", "trace": "  File \"C:\\Users\\Lenovo\\OneDrive\\Рабочий стол\\Автотесты\\python-autotests-basic\\src\\actions\\helper\\registration_user.py\", line 28, in registration_user\n    expect(page.locator(path_info_message)).to_be_visible(timeout=5000)\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\sync_api\\_generated.py\", line 20256, in to_be_visible\n    self._sync(self._impl_obj.to_be_visible(visible=visible, timeout=timeout))\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_sync_base.py\", line 115, in _sync\n    return task.result()\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_assertions.py\", line 677, in to_be_visible\n    await self._expect_impl(\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_assertions.py\", line 74, in _expect_impl\n    raise AssertionError(\n"}, "start": 1749210466707, "stop": 1749210471875}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/'>"}, {"name": "username", "value": "'po12'"}, {"name": "email", "value": "'po12@mail.ru'"}, {"name": "password", "value": "'qwe123!@#'"}], "start": 1749210465922, "stop": 1749210471875}], "attachments": [{"name": "log", "source": "58639fdd-0ae8-457b-80ca-9cb8c170ba34-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "browser_name", "value": "'chromium'"}], "start": 1749210464682, "stop": 1749210471875, "uuid": "9eb6d4ce-0cb0-426e-89f7-d92f5b4399b6", "historyId": "99ea8d245e7c7bb79cfdc66665e57a4e", "testCaseId": "7c5b48a6ab38b27f8df8e17c28d7f6b5", "fullName": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_and_playwright.test_flow_with_promo_code.TestFlowPromoCode#test_coupon_reuse_check", "labels": [{"name": "feature", "value": "Тестирование функционала сайта Pizzeria"}, {"name": "story", "value": "Флоу с промокодом и фреймворком playwright"}, {"name": "epic", "value": "Финальная работа по курсу «Автотесты на Python"}, {"name": "parentSuite", "value": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_and_playwright"}, {"name": "suite", "value": "test_flow_with_promo_code"}, {"name": "subSuite", "value": "TestFlowPromoCode"}, {"name": "host", "value": "Lenovo"}, {"name": "thread", "value": "10780-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_and_playwright.test_flow_with_promo_code"}]}