{"name": "Проверка работы купона, при не работающем сервере", "status": "failed", "statusDetails": {"message": "AssertionError: Locator expected to be visible\nActual value: hidden \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 5000ms\n  -   - waiting for locator(\"//button[@name='apply_coupon']\")\n  -     9 × locator resolved to <button type=\"submit\" class=\"button\" name=\"apply_coupon\" value=\"Применить купон\">Применить купон</button>\n  -       - unexpected value \"hidden\"", "trace": "self = <test_flow_with_promo_code.TestFlowPromoCode object at 0x000001E89A17FD60>\ngo_to_url = <function go_to_url.<locals>.callback at 0x000001E89A6769D0>\npage = <Page url='https://pizzeria.skillbox.cc/checkout/#'>\n\n    @allure.title('Проверка работы купона, при не работающем сервере')\n    def test_coupon_application_wthen_server_down(self, go_to_url, page: Page):\n        \"\"\"\n        Сценарий №3\n        1. Заполните корзину любыми товарами.\n        2. Перейдите в окно оформления товаров.\n        3. Примените промокод GIVEMEHALYAVA.\n        4. Перехватите запрос, уходящий с веба на сервер, и заблокируйте его. Не\n        возвращайте ответ или верните с ошибкой (500, например).\n        5. Убедитесь, что конечная сумма заказа НЕ уменьшилась на 10% и промокод не\n        применился.\n        6. Как думаете, как сайт должен отреагировать на такую ситуацию? Ожидаем ли\n        мы какого-нибудь сообщения для пользователя?\n    \n        Шаги:\n            1. Перейти на главную страницу\n            2. Навести курсор на любую пиццу в слайдере\n            3. Сделать клик по кнопке \"В корзину\"\n            4. Навести курсор на другую пиццу в слайдере\n            5. Сделать клик по кнопке \"В корзину\"\n            6. Перейти на страницу \"Оформление заказа\"\n            7. Проверить что нет активного купона, если есть удалить\n            9. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            10. Ввести в поле купон\n            11. Нажать на кнопку \"Применить купон\"\n            12. Перехватить запрос и изменить сообщение\n    \n        Предусловие: пользователь зарегистрирован и авторизован на сайте https://pizzeria.skillbox.cc/\n    \n        Тестовые данные:\n             Username = zlo\n             Password = qwe123!@#\n             Coupon = GIVEMEHALYAVA\n        \"\"\"\n        path_order_subtotal = \"//tr[@class='cart-subtotal']//bdi\"\n        path_order_total = \"//tr[@class='order-total']//bdi\"\n        coupon = \"GIVEMEHALYAVA\"\n        username = \"zlo\"\n        password = \"qwe123!@#\"\n    \n        def handle(route):\n            route.fulfill(\n                status=500,\n            )\n        page.route(\"**/?wc-ajax=apply_coupon\", handle)\n    \n        go_to_url(\"https://pizzeria.skillbox.cc/\")\n        login_user(page, username, password)\n        page.wait_for_timeout(1000)\n        filling_shopping_cart_goods(page)\n        page.wait_for_timeout(1000)\n        checking_active_coupon(page)\n        page.wait_for_timeout(1000)\n>       input_coupon(page, coupon)\n\ntest_flow_with_promo_code.py:176: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\npage = <Page url='https://pizzeria.skillbox.cc/checkout/#'>\ncoupon = 'GIVEMEHALYAVA'\n\n    @allure.step('Ввод купона')\n    def input_coupon(page: Page, coupon):\n        path_making_order = \"(//a[contains(text(), 'Оформление заказа')])[1]\"\n        path_link_show_coupon = \"//a[@class='showcoupon']\"\n        path_field_coupon = \"//input[@id='coupon_code']\"\n        path_button_appply_coupon = \"//button[@name='apply_coupon']\"\n        path_info_message_success = \"//tr[@class='cart-subtotal']//bdi\"\n        path_info_message_error = \"//ul[@role='alert']\"\n        logging.info('Start mode for input coupon')\n        with step('Перейти на страницу \"Оформление заказа\"'):\n            expect(page.locator(path_making_order)).to_be_visible()\n            page.locator(path_making_order).click()\n            page.wait_for_timeout(1000)\n        with step('Сделать клик по ссылке \"Нажмите для ввода купона\"'):\n            page.locator(path_link_show_coupon).click()\n            page.wait_for_timeout(1000)\n        with step('Ввести в поле для купона'):\n            page.locator(path_field_coupon).type(coupon)\n        with step('Нажать на кнопку \"Применить купон\"'):\n>           expect(page.locator(path_button_appply_coupon)).to_be_visible()\nE           AssertionError: Locator expected to be visible\nE           Actual value: hidden \nE           Call log:\nE             - LocatorAssertions.to_be_visible with timeout 5000ms\nE             -   - waiting for locator(\"//button[@name='apply_coupon']\")\nE             -     9 × locator resolved to <button type=\"submit\" class=\"button\" name=\"apply_coupon\" value=\"Применить купон\">Применить купон</button>\nE             -       - unexpected value \"hidden\"\n\n..\\..\\..\\src\\actions\\helper\\input_coupon.py:26: AssertionError"}, "description": "\n        Сценарий №3\n        1. Заполните корзину любыми товарами.\n        2. Перейдите в окно оформления товаров.\n        3. Примените промокод GIVEMEHALYAVA.\n        4. Перехватите запрос, уходящий с веба на сервер, и заблокируйте его. Не\n        возвращайте ответ или верните с ошибкой (500, например).\n        5. Убедитесь, что конечная сумма заказа НЕ уменьшилась на 10% и промокод не\n        применился.\n        6. Как думаете, как сайт должен отреагировать на такую ситуацию? Ожидаем ли\n        мы какого-нибудь сообщения для пользователя?\n\n        Шаги:\n            1. Перейти на главную страницу\n            2. Навести курсор на любую пиццу в слайдере\n            3. Сделать клик по кнопке \"В корзину\"\n            4. Навести курсор на другую пиццу в слайдере\n            5. Сделать клик по кнопке \"В корзину\"\n            6. Перейти на страницу \"Оформление заказа\"\n            7. Проверить что нет активного купона, если есть удалить\n            9. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            10. Ввести в поле купон\n            11. Нажать на кнопку \"Применить купон\"\n            12. Перехватить запрос и изменить сообщение\n\n        Предусловие: пользователь зарегистрирован и авторизован на сайте https://pizzeria.skillbox.cc/\n\n        Тестовые данные:\n             Username = zlo\n             Password = qwe123!@#\n             Coupon = GIVEMEHALYAVA\n        ", "steps": [{"name": "Открываем страницу 'https://pizzeria.skillbox.cc/'", "status": "passed", "parameters": [{"name": "url", "value": "'https://pizzeria.skillbox.cc/'"}], "start": 1749305142026, "stop": 1749305142819}, {"name": "Авторизация пользователя", "status": "passed", "steps": [{"name": "Нажать на вкладку \"Мой аккаунт\"", "status": "passed", "start": 1749305142819, "stop": 1749305143432}, {"name": "Ввести в поле \"Имя или почта\": zlo", "status": "passed", "start": 1749305143432, "stop": 1749305143448}, {"name": "Ввести в поле пароль: qwe123!@#", "status": "passed", "start": 1749305143448, "stop": 1749305143457}, {"name": "Нажать на кнопку \"Войти\"", "status": "passed", "start": 1749305143457, "stop": 1749305144024}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/'>"}, {"name": "username", "value": "'zlo'"}, {"name": "password", "value": "'qwe123!@#'"}], "start": 1749305142819, "stop": 1749305144024}, {"name": "Заполнение корзины товаром", "status": "passed", "steps": [{"name": "Перейти на главную страницу", "status": "passed", "start": 1749305145035, "stop": 1749305145233}, {"name": "Навести курсор на любую пиццу в слайдере", "status": "passed", "start": 1749305145233, "stop": 1749305146891}, {"name": "Сделать клик по кнопке \"В корзину\"", "status": "passed", "start": 1749305146891, "stop": 1749305147936}, {"name": "Навести курсор на другую пиццу в слайдере", "status": "passed", "start": 1749305147936, "stop": 1749305148789}, {"name": "Сделать клик по кнопке \"В корзину\"", "status": "passed", "start": 1749305148789, "stop": 1749305149825}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/my-account/'>"}], "start": 1749305145035, "stop": 1749305149826}, {"name": "Проверка и удаление активного купона", "status": "passed", "steps": [{"name": "Перейти на страницу \"Оформление заказа\"", "status": "passed", "start": 1749305150839, "stop": 1749305151069}, {"name": "Сделать скролл к сумме заказа\"", "status": "passed", "start": 1749305151069, "stop": 1749305151970}, {"name": "Проверка и удаление активного купона", "status": "passed", "start": 1749305151970, "stop": 1749305151975}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/'>"}], "start": 1749305150839, "stop": 1749305151975}, {"name": "Ввод купона", "status": "failed", "statusDetails": {"message": "AssertionError: Locator expected to be visible\nActual value: hidden \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 5000ms\n  -   - waiting for locator(\"//button[@name='apply_coupon']\")\n  -     9 × locator resolved to <button type=\"submit\" class=\"button\" name=\"apply_coupon\" value=\"Применить купон\">Применить купон</button>\n  -       - unexpected value \"hidden\"\n\n", "trace": "  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\allure_commons\\_allure.py\", line 202, in impl\n    return func(*a, **kw)\n  File \"C:\\Users\\Lenovo\\OneDrive\\Рабочий стол\\Автотесты\\python-autotests-basic\\src\\actions\\helper\\input_coupon.py\", line 26, in input_coupon\n    expect(page.locator(path_button_appply_coupon)).to_be_visible()\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\sync_api\\_generated.py\", line 20256, in to_be_visible\n    self._sync(self._impl_obj.to_be_visible(visible=visible, timeout=timeout))\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_sync_base.py\", line 115, in _sync\n    return task.result()\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_assertions.py\", line 677, in to_be_visible\n    await self._expect_impl(\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_assertions.py\", line 74, in _expect_impl\n    raise AssertionError(\n"}, "steps": [{"name": "Перейти на страницу \"Оформление заказа\"", "status": "passed", "start": 1749305152991, "stop": 1749305154210}, {"name": "Сделать клик по ссылке \"Нажмите для ввода купона\"", "status": "passed", "start": 1749305154210, "stop": 1749305155250}, {"name": "Ввести в поле для купона", "status": "passed", "start": 1749305155250, "stop": 1749305155266}, {"name": "Нажать на кнопку \"Применить купон\"", "status": "failed", "statusDetails": {"message": "AssertionError: Locator expected to be visible\nActual value: hidden \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 5000ms\n  -   - waiting for locator(\"//button[@name='apply_coupon']\")\n  -     9 × locator resolved to <button type=\"submit\" class=\"button\" name=\"apply_coupon\" value=\"Применить купон\">Применить купон</button>\n  -       - unexpected value \"hidden\"\n\n", "trace": "  File \"C:\\Users\\Lenovo\\OneDrive\\Рабочий стол\\Автотесты\\python-autotests-basic\\src\\actions\\helper\\input_coupon.py\", line 26, in input_coupon\n    expect(page.locator(path_button_appply_coupon)).to_be_visible()\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\sync_api\\_generated.py\", line 20256, in to_be_visible\n    self._sync(self._impl_obj.to_be_visible(visible=visible, timeout=timeout))\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_sync_base.py\", line 115, in _sync\n    return task.result()\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_assertions.py\", line 677, in to_be_visible\n    await self._expect_impl(\n  File \"C:\\Users\\Lenovo\\miniconda3\\envs\\Skillbox_1\\lib\\site-packages\\playwright\\_impl\\_assertions.py\", line 74, in _expect_impl\n    raise AssertionError(\n"}, "start": 1749305155266, "stop": 1749305160283}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/checkout/'>"}, {"name": "coupon", "value": "'GIVEMEHALYAVA'"}], "start": 1749305152991, "stop": 1749305160283}], "attachments": [{"name": "log", "source": "7e35688e-9c04-408e-b41e-18f092882287-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "browser_name", "value": "'chromium'"}], "start": 1749305142018, "stop": 1749305160283, "uuid": "f90e7ce9-2630-4ca0-bb3e-34c4d732713b", "historyId": "a0d4eef9e744f6e0986de0761f9712f3", "testCaseId": "61febcb25a93bbd74de6c148af22168e", "fullName": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_in_playwright.test_flow_with_promo_code.TestFlowPromoCode#test_coupon_application_wthen_server_down", "labels": [{"name": "feature", "value": "Тестирование функционала сайта Pizzeria"}, {"name": "story", "value": "Флоу с промокодом на фреймворке playwright"}, {"name": "epic", "value": "Финальная работа по курсу «Автотесты на Python"}, {"name": "parentSuite", "value": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_in_playwright"}, {"name": "suite", "value": "test_flow_with_promo_code"}, {"name": "subSuite", "value": "TestFlowPromoCode"}, {"name": "host", "value": "Lenovo"}, {"name": "thread", "value": "3364-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_in_playwright.test_flow_with_promo_code"}]}