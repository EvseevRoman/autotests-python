{"name": "Проверка повторного использования купона", "status": "failed", "statusDetails": {"message": "AssertionError: Повторное использование купона GIVEMEHALYAVA прошло успешно!\nassert 885.0 == 796.5", "trace": "self = <test_flow_with_promo_code.TestFlowPromoCode object at 0x0000016A046FD8B0>\ngo_to_url = <function go_to_url.<locals>.callback at 0x0000016A04BF9AF0>\npage = <Page url='https://pizzeria.skillbox.cc/checkout/order-received/6472/?key=wc_order_KCBWluL6ExsYc'>\n\n    @allure.title('Проверка повторного использования купона')\n    def test_coupon_reuse_check(self, go_to_url, page: Page):\n        \"\"\"\n        Сценарий №4\n        1. зарегистрируйте одного пользователя;\n        2. сделайте любой заказ;\n        3. примените промокод GIVEMEHALYAVA;\n        4. оформите заказ;\n        5. попробуйте оформить второй заказ с этим же промокодом;\n        6. убедитесь, что второй раз промокод уже не срабатывает для пользователя.\n    \n        Шаги:\n            1. Перейти на страницу \"Мой аккаунт\"\n            2. Сделать клик по кнопке \"Зарегистрироваться\"\n            3. Заполнить обязательные поля валидными значениями\n            4. Нажать на кнопку \"Зарегистрироваться\"\n            5. Перейти на главную страницу\n            6. Навести курсор на любую пиццу в слайдере\n            7. Сделать клик по кнопке \"В корзину\"\n            8. Навести курсор на другую пиццу в слайдере\n            9. Сделать клик по кнопке \"В корзину\"\n            10. Проверить что нет активного купона, если есть удалить\n            11. Перейти на страницу \"Оформление заказа\"\n            12. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            13. Ввести в поле купон\n            14. Нажать на кнопку \"Применить купон\"\n            15. Заполнить все обязательные поля формы \"Детали заказа\"\n            16. Нажать на кнопку \"Оформить заказ\"\n            17. Перейти на главную страницу\n            18. Навести курсор на любую пиццу в слайдере\n            19. Сделать клик по кнопке \"В корзину\"\n            20. Навести курсор на другую пиццу в слайдере\n            21. Сделать клик по кнопке \"В корзину\"\n            22. Перейти на страницу \"Оформление заказа\"\n            23. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            24. Ввести в поле купон\n            25. Нажать на кнопку \"Применить купон\"\n            26. Заполнить все обязательные поля формы \"Детали заказа\"\n            27. Нажать на кнопку \"Оформить заказ\"\n            28. Проверить, что купон при втором заказе не применился\n    \n        Предусловие: пользователь не зарегистрирован и не авторизован на сайте https://pizzeria.skillbox.cc/\n    \n        Тестовые данные:\n             Username = zlo1\n             Password = qwe123!@#\n             Coupon = GIVEMEHALYAVA\n        \"\"\"\n        path_order_subtotal = \"//th[contains(text(), 'Subtotal')]/following-sibling::td/span\"\n        path_order_total = \"//th[contains(text(), 'Total')]/following-sibling::td/span\"\n        coupon = \"GIVEMEHALYAVA\"\n        username = \"po13\"\n        email = \"po13@mail.ru\"\n        password = \"qwe123!@#\"\n    \n        go_to_url(\"https://pizzeria.skillbox.cc/\")\n        registration_user(page, username, email, password)\n        page.wait_for_timeout(1000)\n        filling_shopping_cart_goods(page)\n        page.wait_for_timeout(1000)\n        checking_active_coupon(page)\n        page.wait_for_timeout(1000)\n        input_coupon(page, coupon)\n        page.wait_for_timeout(1000)\n        making_order(page)\n        page.wait_for_timeout(1000)\n        filling_shopping_cart_goods(page)\n        page.wait_for_timeout(1000)\n        input_coupon(page, coupon)\n        page.wait_for_timeout(1000)\n        making_order(page)\n    \n        with step('Проверить, что купон при втором заказе не применился'):\n            page.wait_for_timeout(1000)\n            page.locator(path_order_total).scroll_into_view_if_needed()\n            order_subtotal = float(page.locator(path_order_subtotal).inner_text()[:-1].replace(',', '.'))\n            order_total = float(page.locator(path_order_total).inner_text()[:-1].replace(',', '.'))\n>           assert order_subtotal == order_total, f\"Повторное использование купона {coupon} прошло успешно!\"\nE           AssertionError: Повторное использование купона GIVEMEHALYAVA прошло успешно!\nE           assert 885.0 == 796.5\n\ntest_flow_with_promo_code.py:263: AssertionError"}, "description": "\n        Сценарий №4\n        1. зарегистрируйте одного пользователя;\n        2. сделайте любой заказ;\n        3. примените промокод GIVEMEHALYAVA;\n        4. оформите заказ;\n        5. попробуйте оформить второй заказ с этим же промокодом;\n        6. убедитесь, что второй раз промокод уже не срабатывает для пользователя.\n\n        Шаги:\n            1. Перейти на страницу \"Мой аккаунт\"\n            2. Сделать клик по кнопке \"Зарегистрироваться\"\n            3. Заполнить обязательные поля валидными значениями\n            4. Нажать на кнопку \"Зарегистрироваться\"\n            5. Перейти на главную страницу\n            6. Навести курсор на любую пиццу в слайдере\n            7. Сделать клик по кнопке \"В корзину\"\n            8. Навести курсор на другую пиццу в слайдере\n            9. Сделать клик по кнопке \"В корзину\"\n            10. Проверить что нет активного купона, если есть удалить\n            11. Перейти на страницу \"Оформление заказа\"\n            12. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            13. Ввести в поле купон\n            14. Нажать на кнопку \"Применить купон\"\n            15. Заполнить все обязательные поля формы \"Детали заказа\"\n            16. Нажать на кнопку \"Оформить заказ\"\n            17. Перейти на главную страницу\n            18. Навести курсор на любую пиццу в слайдере\n            19. Сделать клик по кнопке \"В корзину\"\n            20. Навести курсор на другую пиццу в слайдере\n            21. Сделать клик по кнопке \"В корзину\"\n            22. Перейти на страницу \"Оформление заказа\"\n            23. Сделать клик по ссылке \"Нажмите для ввода купона\"\n            24. Ввести в поле купон\n            25. Нажать на кнопку \"Применить купон\"\n            26. Заполнить все обязательные поля формы \"Детали заказа\"\n            27. Нажать на кнопку \"Оформить заказ\"\n            28. Проверить, что купон при втором заказе не применился\n\n        Предусловие: пользователь не зарегистрирован и не авторизован на сайте https://pizzeria.skillbox.cc/\n\n        Тестовые данные:\n             Username = zlo1\n             Password = qwe123!@#\n             Coupon = GIVEMEHALYAVA\n        ", "steps": [{"name": "Открываем страницу 'https://pizzeria.skillbox.cc/'", "status": "passed", "parameters": [{"name": "url", "value": "'https://pizzeria.skillbox.cc/'"}], "start": 1749210745040, "stop": 1749210745877}, {"name": "Регистрация нового пользователя", "status": "passed", "steps": [{"name": "Перейти на страницу \"Мой аккаунт\"", "status": "passed", "start": 1749210745877, "stop": 1749210746069}, {"name": "Нажать на кнопку \"Зарегистрироваться\"", "status": "passed", "start": 1749210746069, "stop": 1749210746335}, {"name": "Ввести в поле \"Имя пользователя\" валидное значение", "status": "passed", "start": 1749210746335, "stop": 1749210746374}, {"name": "Ввести в поле \"Адрес почты\" валидный email", "status": "passed", "start": 1749210746374, "stop": 1749210746410}, {"name": "Ввести в поле \"Пароль\" валидный пароль", "status": "passed", "start": 1749210746410, "stop": 1749210746427}, {"name": "Сделать клик по кнопке \"Зарегистрироваться\"", "status": "passed", "start": 1749210746427, "stop": 1749210746828}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/'>"}, {"name": "username", "value": "'po13'"}, {"name": "email", "value": "'po13@mail.ru'"}, {"name": "password", "value": "'qwe123!@#'"}], "start": 1749210745877, "stop": 1749210746828}, {"name": "Заполнение корзины товаром", "status": "passed", "steps": [{"name": "Перейти на главную страницу", "status": "passed", "start": 1749210747835, "stop": 1749210747985}, {"name": "Навести курсор на любую пиццу в слайдере", "status": "passed", "start": 1749210747985, "stop": 1749210749459}, {"name": "Сделать клик по кнопке \"В корзину\"", "status": "passed", "start": 1749210749459, "stop": 1749210750499}, {"name": "Навести курсор на другую пиццу в слайдере", "status": "passed", "start": 1749210750499, "stop": 1749210751359}, {"name": "Сделать клик по кнопке \"В корзину\"", "status": "passed", "start": 1749210751359, "stop": 1749210752400}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/register/'>"}], "start": 1749210747834, "stop": 1749210752400}, {"name": "Проверка и удаление активного купона", "status": "passed", "steps": [{"name": "Перейти на страницу \"Оформление заказа\"", "status": "passed", "start": 1749210753407, "stop": 1749210753599}, {"name": "Сделать скролл к сумме заказа\"", "status": "passed", "start": 1749210753599, "stop": 1749210753732}, {"name": "Проверка и удаление активного купона", "status": "passed", "start": 1749210753732, "stop": 1749210753738}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/'>"}], "start": 1749210753406, "stop": 1749210753738}, {"name": "Ввод купона", "status": "passed", "steps": [{"name": "Перейти на страницу \"Оформление заказа\"", "status": "passed", "start": 1749210754756, "stop": 1749210755988}, {"name": "Сделать клик по ссылке \"Нажмите для ввода купона\"", "status": "passed", "start": 1749210755988, "stop": 1749210757031}, {"name": "Ввести в поле для купона", "status": "passed", "start": 1749210757031, "stop": 1749210757068}, {"name": "Нажать на кнопку \"Применить купон\"", "status": "passed", "start": 1749210757068, "stop": 1749210757100}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/checkout/'>"}, {"name": "coupon", "value": "'GIVEMEHALYAVA'"}], "start": 1749210754755, "stop": 1749210757100}, {"name": "Проверка и удаление активного купона", "status": "passed", "steps": [{"name": "Перейти на страницу \"Оформление заказа\"", "status": "passed", "start": 1749210758113, "stop": 1749210758406}, {"name": "Ввести в поле \"Дата заказа\", завтрашнюю дату", "status": "passed", "start": 1749210758406, "stop": 1749210758509}, {"name": "Ввести в поле имя валидное значение", "status": "passed", "start": 1749210758509, "stop": 1749210758528}, {"name": "Ввести валидное значение в поле \"Фамилия\"", "status": "passed", "start": 1749210758528, "stop": 1749210758565}, {"name": "Ввести валидный адрес доставки", "status": "passed", "start": 1749210758565, "stop": 1749210758586}, {"name": "Ввести валидное название города", "status": "passed", "start": 1749210758586, "stop": 1749210758608}, {"name": "Ввести корректное название области", "status": "passed", "start": 1749210758608, "stop": 1749210758628}, {"name": "Ввести в поле \"Почтовый индекс\" валидный индекс", "status": "passed", "start": 1749210758628, "stop": 1749210758648}, {"name": "Ввести в поле \"Телефон\" валидный номер телефона", "status": "passed", "start": 1749210758648, "stop": 1749210758668}, {"name": "Сделать клик по кнопке \"Оплата при доставке\"", "status": "passed", "start": 1749210758668, "stop": 1749210758891}, {"name": "Сделать клик по чек-боксу", "status": "passed", "start": 1749210758891, "stop": 1749210758919}, {"name": "Сделать клик по кнопке \"Оформить заказ\"", "status": "passed", "start": 1749210758919, "stop": 1749210758948}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/checkout/'>"}], "start": 1749210758113, "stop": 1749210758948}, {"name": "Заполнение корзины товаром", "status": "passed", "steps": [{"name": "Перейти на главную страницу", "status": "passed", "start": 1749210759968, "stop": 1749210760156}, {"name": "Навести курсор на любую пиццу в слайдере", "status": "passed", "start": 1749210760156, "stop": 1749210761577}, {"name": "Сделать клик по кнопке \"В корзину\"", "status": "passed", "start": 1749210761577, "stop": 1749210762622}, {"name": "Навести курсор на другую пиццу в слайдере", "status": "passed", "start": 1749210762624, "stop": 1749210763475}, {"name": "Сделать клик по кнопке \"В корзину\"", "status": "passed", "start": 1749210763475, "stop": 1749210764514}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/checkout/order-received/6471/?key=wc_order_feRFqD9Qj8c85'>"}], "start": 1749210759968, "stop": 1749210764514}, {"name": "Ввод купона", "status": "passed", "steps": [{"name": "Перейти на страницу \"Оформление заказа\"", "status": "passed", "start": 1749210765530, "stop": 1749210766755}, {"name": "Сделать клик по ссылке \"Нажмите для ввода купона\"", "status": "passed", "start": 1749210766755, "stop": 1749210767808}, {"name": "Ввести в поле для купона", "status": "passed", "start": 1749210767808, "stop": 1749210767848}, {"name": "Нажать на кнопку \"Применить купон\"", "status": "passed", "start": 1749210767848, "stop": 1749210767875}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/'>"}, {"name": "coupon", "value": "'GIVEMEHALYAVA'"}], "start": 1749210765529, "stop": 1749210767875}, {"name": "Проверка и удаление активного купона", "status": "passed", "steps": [{"name": "Перейти на страницу \"Оформление заказа\"", "status": "passed", "start": 1749210768890, "stop": 1749210769092}, {"name": "Ввести в поле \"Дата заказа\", завтрашнюю дату", "status": "passed", "start": 1749210769092, "stop": 1749210769203}, {"name": "Ввести в поле имя валидное значение", "status": "passed", "start": 1749210769203, "stop": 1749210769245}, {"name": "Ввести валидное значение в поле \"Фамилия\"", "status": "passed", "start": 1749210769245, "stop": 1749210769267}, {"name": "Ввести валидный адрес доставки", "status": "passed", "start": 1749210769267, "stop": 1749210769287}, {"name": "Ввести валидное название города", "status": "passed", "start": 1749210769287, "stop": 1749210769306}, {"name": "Ввести корректное название области", "status": "passed", "start": 1749210769306, "stop": 1749210769327}, {"name": "Ввести в поле \"Почтовый индекс\" валидный индекс", "status": "passed", "start": 1749210769327, "stop": 1749210769347}, {"name": "Ввести в поле \"Телефон\" валидный номер телефона", "status": "passed", "start": 1749210769347, "stop": 1749210769367}, {"name": "Сделать клик по кнопке \"Оплата при доставке\"", "status": "passed", "start": 1749210769367, "stop": 1749210769429}, {"name": "Сделать клик по чек-боксу", "status": "passed", "start": 1749210769429, "stop": 1749210769452}, {"name": "Сделать клик по кнопке \"Оформить заказ\"", "status": "passed", "start": 1749210769452, "stop": 1749210769482}], "parameters": [{"name": "page", "value": "<Page url='https://pizzeria.skillbox.cc/checkout/'>"}], "start": 1749210768890, "stop": 1749210769483}, {"name": "Проверить, что купон при втором заказе не применился", "status": "failed", "statusDetails": {"message": "AssertionError: Повторное использование купона GIVEMEHALYAVA прошло успешно!\nassert 885.0 == 796.5\n", "trace": "  File \"C:\\Users\\Lenovo\\OneDrive\\Рабочий стол\\Автотесты\\python-autotests-basic\\tests\\the_final_work_on_autotests_in_python\\flow_with_promo_code_and_playwright\\test_flow_with_promo_code.py\", line 263, in test_coupon_reuse_check\n    assert order_subtotal == order_total, f\"Повторное использование купона {coupon} прошло успешно!\"\n"}, "start": 1749210769483, "stop": 1749210770554}], "attachments": [{"name": "log", "source": "6d9d0a4b-5db1-49bc-893f-8c613fa990ed-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "browser_name", "value": "'chromium'"}], "start": 1749210745040, "stop": 1749210770554, "uuid": "1f1b0b43-69d7-4f34-8deb-327085006a09", "historyId": "99ea8d245e7c7bb79cfdc66665e57a4e", "testCaseId": "7c5b48a6ab38b27f8df8e17c28d7f6b5", "fullName": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_and_playwright.test_flow_with_promo_code.TestFlowPromoCode#test_coupon_reuse_check", "labels": [{"name": "feature", "value": "Тестирование функционала сайта Pizzeria"}, {"name": "story", "value": "Флоу с промокодом и фреймворком playwright"}, {"name": "epic", "value": "Финальная работа по курсу «Автотесты на Python"}, {"name": "parentSuite", "value": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_and_playwright"}, {"name": "suite", "value": "test_flow_with_promo_code"}, {"name": "subSuite", "value": "TestFlowPromoCode"}, {"name": "host", "value": "Lenovo"}, {"name": "thread", "value": "20240-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.the_final_work_on_autotests_in_python.flow_with_promo_code_and_playwright.test_flow_with_promo_code"}]}